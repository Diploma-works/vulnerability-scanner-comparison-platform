from fastapi import APIRouter, Depends, BackgroundTasks

from app.services.dependencies import get_analyze_service
from common.services.AnalyzeService import AnalyzeService

router = APIRouter(prefix="/analyze", tags=["analyze"])


@router.post(
    path="/{scan_id}",
    description="Запускает анализ отчета указанного скана"
)
async def analyze_scan_report(
        scan_id: int,
        background_tasks: BackgroundTasks,
        analyzer_service: AnalyzeService = Depends(get_analyze_service)
):

    background_tasks.add_task(analyzer_service.analyze_scan_report, scan_id)
