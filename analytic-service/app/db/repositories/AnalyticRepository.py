from pypika.queries import QueryBuilder, Table

from app.db import BaseRepository
from app.models.analytic import StatisticDB

statistic = Table('scan_statistic')


class AnalyticRepository(BaseRepository):

    async def insert_scan_statistics(
            self, scan_id: int, info_count: int, low_count: int, medium_count: int, high_count: int,
            critical_count: int,
    ) -> None:
        pass

    async def delete_scan_statistics(self) -> None:
        pass

    async def get_scan_statistics_by_scan_id(self, scan_id: int) -> StatisticDB:
        q: QueryBuilder = QueryBuilder().from_(statistic).select('*').where(statistic.scan_id == scan_id)
        return await self.fetch_one(q, serializer=StatisticDB)
