from typing import Optional, Any, List

from pydantic import BaseModel


class Vulnerability(BaseModel):
    id: int
    scan_id: int
    vuln_group_id: int
    severity_id: int
    name: str
    method: Optional[str]
    vector: Optional[str]
    url: Optional[str]
    path: Optional[str]
    query_params: Optional[str]
    is_false_positive: bool


class ParsedVulnerability(BaseModel):
    scan_id: int
    vuln_group_id: int
    severity_id: int
    name: str
    vector: Optional[str]
    request: Optional[Any]
    is_false_positive: bool
    is_duplicate: Optional[bool]


class VulnerabilityDuplicates(BaseModel):
    vulner_id: int
    duplicates_ids: str

    @property
    def duplicates_ids_list(self) -> List[int]:
        return [int(i) for i in self.duplicates_ids.split(',')]
