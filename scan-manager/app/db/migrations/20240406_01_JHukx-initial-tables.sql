-- initial-tables
-- depends: 

CREATE TABLE IF NOT EXISTS scan (
    id SERIAL PRIMARY KEY NOT NULL,
    target_id INTEGER NOT NULL,
    scanner_id INTEGER NOT NULL,
    started_at TIMESTAMP WITH TIME ZONE NOT NULL,
    finished_at TIMESTAMP WITH TIME ZONE,
    status_id INTEGER NOT NULL,
    report_path text
);

CREATE TABLE IF NOT EXISTS scan_status (
    id SERIAL PRIMARY KEY NOT NULL,
    name varchar(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS scan_container_info
(
    scan_id
    INTEGER
    NOT
    NULL,
    container_id
    text
    NOT
    NULL
);

INSERT INTO scan_status (id, name)
VALUES
    (1, 'STARTED'),
    (2, 'IN_PROGRESS'),
    (3, 'ATTACK_FINISH'),
    (4, 'ATTACK_ERROR'),
    (5, 'ANALYSIS'),
    (6, 'ANALYSIS_ERROR'),
    (7, 'ANALYSIS_FINISH'),
    (8, 'FINISH');